<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
    <head th:replace="fragments/layout :: head(title='Profile')" lang="en">
        <meta charset="UTF-8" />
        <title th:text="${title}">Title</title>
    </head>
    <body>
        <header th:replace="fragments/layout :: navbar(${currentUser})">
            <p>Navbar</p>
        </header>

        <div th:replace="fragments/layout :: accountSearch" />

        <h2 th:text="${account.name}">Name</h2>
        <h3>Profile picture</h3>
        <img th:if="${account.profilePicture != null}" th:src="@{/photos/{id}(id=${account.profilePicture.id})}"/>

        <h3>Messages</h3>

        <table>
            <tr>
                <th>
                    Messages
                </th>
            </tr> 
            <tr th:each="message : ${messages}">
                <td>
                    <span th:text="${message.user.username + ': ' + message.content + ': ' + {#lists.size(message.likes)}}">Message</span>
                    <form method="POST" th:action="@{/messages/{id}/like(id=${message.id})}">
                        <input type="hidden" name="value" value="like"/>
                        <input type="submit" value="Like"/>
                    </form>
                    <h4>Comments</h4>
                    <ul>
                        <li th:each="comment : ${message.comments}">
                            <span th:text="${comment.user.username + ': ' + comment.content}">Comment</span>
                        </li>
                    </ul>
                    <form class="form-inline" method="POST" th:action="@{/messages/{id}/comment(id=${message.id})}">
                        <input class="form-control mb-2 mr-sm-2" type="text" name="content"/>
                        <input class="btn btn-primary mb-2" type="submit" value="Add comment"/>
                    </form>
                </td>
            </tr>
        </table>
        <h4>Add message</h4>
        <form class="form-inline" method="POST" th:action="@{/messages}" action="/messages">
            <input class="form-control mb-2 mr-sm-2" type="text" name="content"/>
            <input class="btn btn-primary mb-2" type="submit" value="Add message"/>
        </form>

        <h3>Followers</h3>
        <ol>
            <li th:if='${follower.acceptedAsFollower == true}' th:each="follower : ${followers}">
                <p th:text="${follower.theOneWhoFollows.name} + ' : ' + ${follower.date}">Name</p>
            </li>
        </ol>
        <h3>Following</h3>
        <ol>
            <li th:if='${follower.acceptedAsFollower == true}' th:each="follower : ${following}">
                <p th:text="${follower.theOneBeingFollowed.name} + ' : ' + ${follower.date}">Name</p>
            </li>
        </ol>

        <h2>Photo album (<span th:text="${count}">count</span> photos)</h2>
        <div th:each="photo : ${account.photos}">
            <img th:src="@{/photos/{id} (id=${photo.id})}"/>
            <div th:text="${photo.description}"></div>
            <form method="POST" th:action="@{/photos/profilePicture/{id} (id=${photo.id})}">
                <input type="submit" value="Set as profile picture"/>
            </form>

            <div th:text="'Likes: ' + ${#lists.size(photo.likes)}">Likes</div>
            <form method="POST" th:action="@{/photos/{id}/like (id=${photo.id})}">
                <input type="submit" value="Like"/>
            </form>
            <form th:method="delete" th:action="@{/photos/{id}/delete (id=${photo.id})}">
                <input type="submit" value="Delete"/>
            </form>
            <h4>Comments</h4>
            <ul>
                <li th:each="comment : ${photo.comments}">
                    <span th:text="${comment.user.username + ': ' + comment.content}">Comment</span>
                </li>
            </ul>
            <form class="form-inline" method="POST" th:action="@{/photos/{id}/comment(id=${photo.id})}">
                <input class="form-control mb-2 mr-sm-2" type="text" name="content"/>
                <input class="btn btn-primary mb-2" type="submit" value="Add comment"/>
            </form>
        </div>
    </body>
</html>
